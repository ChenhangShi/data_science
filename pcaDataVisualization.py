"""
1、取得pca返回点题目数据，标准化到[0,1]区间
2、根据区间，分为10组
3、数据的可视化
"""

from pca import do_pca
import matplotlib.pyplot as plt
from SampleData import getSampleData


# 总过程
def do_visualization():
    visualization(normalization())
    return 0


# 数据标准化，采用（x - min） / (max - min)
def normalization():
    # raw_data = do_pca()[0]
    # ⬇️暂时这样，节省运行时间
    raw_data = {'2908': 0.6874480214104849, '2804': -0.5382681108133515, '2190': 2.434790316884371, '2198': 3.5777932241218373, '2200': 0.5129578919878262, '2647': -0.5396285971761355, '2145': -0.11987872071958164, '2142': 0.1810119444999933, '2140': 0.7599282406221166, '2558': 0.20664398040929963, '2615': -0.5443957454205096, '2394': -0.598040422148762, '2425': -0.8446548619508718, '2423': -0.900213949218953, '2388': -0.9617268602127863, '2386': -0.6100127417339066, '2280': -0.9974809748808682, '2358': -0.9273241020082075, '2278': -0.7812185067654481, '2462': 0.14053505678013187, '2445': 0.19193393470112885, '2453': -0.9580264253992501, '2534': -0.620543873470008, '2396': -0.5670517968218401, '2111': -0.8543359572594936, '2097': -0.45694334684554894, '2108': -0.21037563671537074, '2068': -0.8128518482248194, '2122': -0.9170627640672835, '2063': -0.9578222649153881, '2134': -0.8270923612116693, '2085': 1.3152598664179065, '2193': 1.5192334363521964, '2126': -0.799566912659764, '2273': 1.453869279271296, '2301': 0.8784893783113696, '2288': 0.8371680364944097, '2383': 1.737930914841462, '2312': 0.19435694308644702, '2091': 1.8431846649394719, '2103': 3.2552308344974814, '2789': 1.0805419138913974, '2809': -0.6483481864166797, '2828': -1.0135257990142559, '2847': -1.0765407167734327, '2811': -0.4775946024014181, '2795': 0.7942559830437357, '2816': -0.884500920580724, '2801': -0.4591973792203081, '2785': 0.2736371951929976, '2815': -0.37156461804778795, '2844': 1.3636819416381578, '2842': -0.35496339068404914, '2848': 0.9556412488780557, '2855': -0.16373622911835017, '2853': -0.7466843801943938, '2872': -0.6550190532285792, '2836': 0.3927967142157242, '2890': 0.5540920409269042, '2887': 0.7530391752019168, '2884': -0.9739318094465748, '2929': -0.5834203704164177, '2869': -0.8700709225767423, '2878': 0.004757754234349671, '2930': -0.8120621544904859, '2916': -0.33193032129330924, '2909': -0.7262709985872884, '2952': 0.2726275286320461, '2947': 0.7039569366752548, '2197': -0.07010647606296519, '2669': -0.9350289046185077, '2204': -0.861498397834543, '2662': -1.0132484672161894, '2658': -0.7640927519567812, '2673': -0.673379867486829, '2293': -1.0319084660542874, '2489': -0.7571771641599517, '2528': -0.4803131293246661, '2282': -0.7873345733384854, '2738': 0.49429061974068356, '2147': 1.3149686435532157, '2155': -0.058693796068118226, '2130': -0.9020693315254042, '2226': -0.6747611910179336, '2123': -0.9056953888813684, '2118': -0.904260191984213, '2158': -0.3891028643821363, '2156': -0.42637807307073206, '2492': -0.22573950970475154, '2404': 1.0770005219427672, '2458': -0.048100852791785303, '2455': 0.352646022670494, '2495': -0.77938189328128, '2525': -0.11430899497662819, '2578': -0.47497993401131805, '2603': 0.20831228291755674, '2210': 0.5154494066501348, '2689': -0.6756409521638874, '2684': 0.336246856757556, '2681': -0.9085860700019514, '2679': -0.377793145457203, '2675': -1.0763228258915494, '2951': 0.12230725419988063, '2939': -0.022027774476530457, '2935': -0.9153129230282443, '2327': -0.35449395443988996, '2247': -0.32556384522010984, '2244': -0.6347767905229141, '2242': -0.7703686003557404, '2217': -0.5966784412034215, '2334': -0.7407046323017943, '2221': 0.2519049802359715, '2264': 1.9249139102655157, '2234': 1.5899658783263428, '2644': -0.6132536933518757, '2565': -0.4311951001127751, '2563': -0.43151512597209657, '2504': -0.02898283039773305, '2551': -0.8849024127248384, '2493': -0.9246859753257555, '2369': -0.7069857351923572, '2512': -0.7875995116667885, '2499': 0.2891523515444747, '2310': 2.832601640270628, '2473': 0.6163241875829165, '2724': -0.935942615874473, '2487': -0.07025446167292995, '2649': 0.046159894522829856, '2560': 0.604705808021407, '2732': -0.33584966331683686, '2954': 2.6384491089299704, '2984': 0.338404656295071, '2969': 1.7231728917766653, '2978': 0.5719204810539861, '2348': 2.283385672136616, '2331': 2.225509599292633, '2393': -0.5891009157528972, '2497': -0.564205467115911, '2524': 2.7310514336615714, '2549': -0.3706506869826605, '2416': 0.11687511145567192, '2599': 0.1726247634361828, '2697': 0.43623448303536205, '2638': 0.017973459939968586, '2250': 0.7097458521810008, '2401': -0.11041532477219096, '2420': -0.9463780137851109, '2329': 0.2810932797485356, '2381': -0.015865392613266624, '2332': -0.2182990685759946, '2745': 0.38946696928070373, '2706': 0.13138826353765215, '2715': 1.0863732675541111, '2770': 0.7268568710411065, '2766': -0.09997279899885317, '2763': 0.3567061549385453, '2779': -0.6099209346257636, '2774': -0.8913195323907364, '2475': -0.5180486382480112, '2977': -0.10509230471769562, '2986': 0.476448017654419, '2989': -0.9764104413653748, '2742': 0.9819469121054454, '2781': 0.04870749992896524, '2734': 0.6018059849834111, '2652': 0.7497371468978316, '2595': -0.9305760897370242, '2622': -0.33404855111653214, '2585': -0.5658103276169213, '2626': 0.2870818107798579, '2580': 0.15737190762495917, '2413': -0.018827000599811957, '2616': 0.05032337381787933, '2571': -0.08377781146776372, '2752': 0.03168274043792106, '2769': -0.12591914481378944, '2588': 0.6194320079593382}
    raw_data = sorted(raw_data.items(), key=lambda item: item[1])
    raw_data = [list(x) for x in raw_data]
    min_num = raw_data[0][1]
    max_num = raw_data[-1][1]
    max_sub_min = max_num - min_num
    for x in raw_data:
        x[1] = (x[1] - min_num) / max_sub_min
    return raw_data

def visualization(normalized_data):
    # 按0.1 为单位长度，分成10个区间
    section_num = [0 for i in range(0, 10)]
    # 统计每个区间题目个数
    for i in range(0, len(normalized_data) - 1):
        pos = int(normalized_data[i][1] * 10)
        section_num[pos] += 1
    # 最后一个数，放在这里是不想在循环中添加判断语句
    section_num[-1] += 1
    # 绘图

    # 中文乱码的处理
    plt.rcParams['font.sans-serif'] = ['Microsoft YaHei']
    plt.rcParams['axes.unicode_minus'] = False

    plt.bar(range(10), section_num, align='center', color='steelblue', alpha=0.8)
    plt.ylabel('num')
    plt.title('各难度区间题目个数  总数{}'.format(len(normalized_data)))
    plt.xticks(range(10), ["{:.1f}-{:.1f}".format(x / 10, x / 10 + 0.1) for x in range(0, 10)])
    # 为每个条形图添加数值标签
    for x, y in enumerate(section_num):
        plt.text(x, y + 100, '%s' % round(y, 1), ha='center')
    plt.show()



if __name__ == '__main__':
    do_visualization()

"""
标准化之后的运行结果：
[['2847', 0.0], ['2675', 4.68146215227039e-05], ['2293', 0.009589395880468372], ['2828', 0.013538976480715463], ['2662', 0.013598562191923175], ['2280', 0.016986263318561363], ['2989', 0.021513341474762682], ['2884', 0.022045884251081664], ['2388', 0.024668160475516218], ['2453', 0.02546321189652028], ['2063', 0.02550707649378695], ['2420', 0.027965914058002618], ['2724', 0.030207995963417122], ['2669', 0.030404310037045783], ['2595', 0.03136101295910277], ['2358', 0.03205971394835564], ['2493', 0.03262652473502312], ['2122', 0.03426439845772503], ['2935', 0.034640357952952526], ['2681', 0.036085645960155344], ['2123', 0.036706718955194235], ['2118', 0.037015076051049554], ['2130', 0.037485790118116986], ['2423', 0.03788442552546258], ['2774', 0.039795422231149284], ['2551', 0.04117416293763663], ['2816', 0.04126042493542467], ['2869', 0.044360760705746745], ['2204', 0.046202597765798874], ['2111', 0.047741473288269796], ['2425', 0.04982149062943196], ['2134', 0.053594855618327525], ['2068', 0.056654479866971516], ['2930', 0.05682414834034744], ['2126', 0.059508794949163495], ['2512', 0.06208003309944402], ['2282', 0.06213695603012916], ['2278', 0.06345101442187853], ['2495', 0.06384561728181316], ['2242', 0.06578215493467567], ['2658', 0.0671305430131108], ['2489', 0.06861638134887475], ['2853', 0.07087079284981222], ['2334', 0.0721555626941198], ['2909', 0.0752566796096219], ['2369', 0.07940018620795199], ['2689', 0.0861347229701424], ['2226', 0.08632374274335286], ['2673', 0.08662052495723048], ['2872', 0.09056541041053297], ['2809', 0.09199866958286824], ['2244', 0.09491453167314942], ['2534', 0.09797252390869762], ['2644', 0.09953884472080719], ['2386', 0.10023517456286955], ['2779', 0.10025489964261435], ['2394', 0.1028074694899589], ['2217', 0.10310009588132577], ['2393', 0.10472815384767502], ['2929', 0.10594863897156513], ['2396', 0.10946548451862724], ['2585', 0.10973221853915179], ['2497', 0.110077028456401], ['2615', 0.11433321676324838], ['2647', 0.11535745531271892], ['2804', 0.11564976058777239], ['2475', 0.11999398530866791], ['2528', 0.12810159198290808], ['2811', 0.1286856770437933], ['2578', 0.1292474477339293], ['2801', 0.13263838508209347], ['2097', 0.1331226718572546], ['2563', 0.13858601445285726], ['2565', 0.13865477313312932], ['2156', 0.13968972831752605], ['2158', 0.14769843786908557], ['2679', 0.1501283707163101], ['2815', 0.15146659171388144], ['2549', 0.1516629530142809], ['2842', 0.15503342374066667], ['2327', 0.15513428376706798], ['2732', 0.15914007522075702], ['2622', 0.15952705050512142], ['2916', 0.15998215962494863], ['2247', 0.16135001937761065], ['2492', 0.1827976285915204], ['2332', 0.1843962335096982], ['2108', 0.18609861068358438], ['2855', 0.19611925127132213], ['2769', 0.20424438470282802], ['2145', 0.20554219104223434], ['2525', 0.20673886618709558], ['2401', 0.2075754349107588], ['2977', 0.2087191044716652], ['2766', 0.20981904826251782], ['2571', 0.21329859823395245], ['2487', 0.21620413745107028], ['2197', 0.21623593267931215], ['2155', 0.21868798707415685], ['2458', 0.2209639181549197], ['2504', 0.22507149243661698], ['2939', 0.22656581063757203], ['2413', 0.22725350815076398], ['2381', 0.22788982003215333], ['2878', 0.23232077559088776], ['2638', 0.2351602163945437], ['2752', 0.23810570347648596], ['2649', 0.24121617089647607], ['2781', 0.24176353286888436], ['2616', 0.2421107090512198], ['2416', 0.2564095837093177], ['2951', 0.25757669866350685], ['2706', 0.259527785425456], ['2462', 0.2614930060904606], ['2580', 0.2651104626500105], ['2599', 0.26838759231129344], ['2142', 0.2701896076308468], ['2445', 0.27253623559949547], ['2312', 0.273056827464215], ['2558', 0.27569674060299787], ['2603', 0.2760551812584048], ['2221', 0.2854212254383009], ['2952', 0.2898735377689645], ['2785', 0.2900904681770043], ['2329', 0.2916924341403885], ['2626', 0.29297909107290976], ['2499', 0.29342395403094207], ['2684', 0.3035423739404561], ['2984', 0.3040059847524254], ['2455', 0.3070657923546027], ['2763', 0.30793812603749054], ['2745', 0.31497690210259105], ['2836', 0.31569230950079336], ['2697', 0.32502506674839265], ['2986', 0.3336650859497914], ['2738', 0.33749863169722705], ['2200', 0.3415093607261699], ['2210', 0.3420446714051946], ['2890', 0.35034717714876334], ['2978', 0.3541776801495111], ['2734', 0.3605986856701585], ['2560', 0.3612217228382733], ['2473', 0.3637179725077318], ['2588', 0.364385698634797], ['2908', 0.37899917809606304], ['2947', 0.3825461765440503], ['2250', 0.3837899453795611], ['2770', 0.38746630790047093], ['2652', 0.3923822155571364], ['2887', 0.3930916679398011], ['2140', 0.3945718078497609], ['2795', 0.4019472439180668], ['2288', 0.41116704937156634], ['2301', 0.4200450848416666], ['2848', 0.4366214353026405], ['2742', 0.44227329947084204], ['2404', 0.46269590151108964], ['2789', 0.46345678201377855], ['2715', 0.46470966883641845], ['2147', 0.5138241885296776], ['2085', 0.5138867587853552], ['2844', 0.5242904117752687], ['2273', 0.543667478135013], ['2193', 0.5577111969379505], ['2234', 0.5729083106114358], ['2969', 0.6015283054682509], ['2383', 0.6046991185753907], ['2091', 0.6273132565883938], ['2264', 0.6448730720988217], ['2331', 0.7094571120160986], ['2348', 0.721891989611678], ['2190', 0.7544218094893278], ['2954', 0.7981786165065795], ['2524', 0.8180745513293801], ['2310', 0.8398929700115435], ['2103', 0.9306963372803648], ['2198', 1.0]]
统计各个区间题目个数的结果：
[54, 35, 38, 24, 8, 6, 4, 4, 2, 2]
"""